var e,t,r,o,n;e=module.exports,Object.defineProperty(e,"__esModule",{value:!0,configurable:!0}),t=module.exports,r="default",o=()=>f,Object.defineProperty(t,r,{get:o,set:n,enumerable:!0,configurable:!0});new class{parse(e=""){if(-1===(e=e||window.location.href).indexOf("?"))return{};let t="?"===e[0]?e.substr(1):e.substring(e.lastIndexOf("?")+1);return t?(t=t.split("&"),Array.from(t).reduce(((e,t)=>{const r=t.split("=");let o=decodeURIComponent(r[1]);return-1!==o.indexOf(",")&&(o=o.split(",")),e[r[0]]=o,e}),{})):{}}stringify(e="",t={}){if(l(t))return`${e}?${Object.keys(t).reduce(((e,r)=>{let o=t[r];return d(t[r])&&(o=o.reduce(((e,t)=>(e.push(t),e)),[]).join(",")),e.push(`${r}=${encodeURIComponent(o)}`),e}),[]).join("&")}`}};new class{randomColor(){return`#${(268435456*Math.random()<<0).toString(16).slice(-6)}`}randomNumber(e,t){return Math.floor(Math.random()*(t-e+1)+e)}pick(e){return e[this.randomNumber(0,e.length-1)]}};const s=()=>{},i=Object.assign,a=(Object.prototype.hasOwnProperty,Object.prototype.toString),c=e=>a.call(e),l=e=>"[object Object]"===c(e),d=Array.isArray,u=e=>"function"==typeof e;class h{constructor(){this.models={id:[],data:{}}}async load(e,t){if(t=i({manual:!1,onSuccess:s,onProgress:s},t),!u(e))throw new Error("Expected a function to fetch data!");const r=this;return new Promise((async t=>{const o=await e();r.cache(o.data),t()}))}add(e){return this.cache(e),this}cache(e){if(!d(e))throw new Error("parameter error. not expected type.");const t=this.models;return t.id=Array.from(new Set([...t.id,...e.map((e=>e.id))])),t.data=e.reduce(((e,t)=>(e[t.id]=t,e)),t.data),this}all(){return Object.values(this.models.data)}filter(e){const t=this.all();if(u(e))return t.filter(e)}filterOutdoor(){return this.all().filter((e=>!e.indoor))}filterIndoor(e,t){const r=this.all(),o=`${e}#${t}`;return r.filter((t=>t.build_id===e&&t.floor_id===o))}one(e){return this.models.data[e]}batchedAddModel(e,t,r=100,o){if(!d(t)||r>200)return;const n=+new Date,s=t.length,i=(a,c=0)=>{const l=t.slice(a,c);a>s-1?setTimeout((()=>{const e=+new Date;console.log(`加载 ${s} 个模型,共耗时: ${(e-n)/1e3}s. `),o&&o()}),0):e.OverLayerCreateObjects(l,(e=>{a<s&&setTimeout((()=>{i(c,c+r)}),10)}))};i(0,r)}}var f=new class{constructor(){this.controllers=new Map}create(e){if(!e)throw new Error("controller key is required!");const t=this.get(e);if(t)return t;const r=new h;return this.controllers.set(e,r),this.get(e)}get(e){return this.controllers.get(e)}};
//# sourceMappingURL=index.js.map
